 package com.sathya.springmvc.product.service;



import java.util.List;
import java.util.Optional;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.sathya.springmvc.product.entity.ProductEntity;
import com.sathya.springmvc.product.model.ProductModel;
import com.sathya.springmvc.product.repository.ProductRepository;

@Service
public class ProductService {
	@Autowired
	
	ProductRepository productRepository;
	public void saveProductDetails(ProductModel productModel) {
		double stockvalue=productModel.getPrice()*productModel.getQuantity();
		double discountprice=productModel.getPrice()*productModel.getDiscountrate()/100;
		double offerprice=productModel.getPrice()-discountprice;
        double taxprice=productModel.getPrice();
        double finalprice=offerprice + taxprice;
       
        ProductEntity productEntity=new ProductEntity();
        productEntity.setName(productModel.getName());
        productEntity.setBrand(productModel.getBrand());
        productEntity.setMadein(productModel.getMadein());
        productEntity.setPrice(productModel.getPrice());
        productEntity.setQuantity(productModel.getQuantity());
        productEntity.setDiscountrate(productModel.getDiscountrate());
        productEntity.setDiscountprice(discountprice);
        productEntity.setStockvalue(stockvalue);
        productEntity.setOfferprice(offerprice);
        productEntity.setTaxprice(taxprice);
        productEntity.setFinalprice(finalprice);
        
        productRepository.save(productEntity);
	}
	public List<ProductEntity>getAllProducts(){
		List<ProductEntity>products=productRepository.findAll();
		return products;
		
	}
	public ProductEntity searchbyid(long id) {
		Optional<ProductEntity>optionalData=productRepository.findById(id);
		if(optionalData.isPresent()) 
		{
			ProductEntity product=optionalData.get();
			return product;
		}
		else {
			return null;
			
		}
	}
	public void deleteproductById(Long id) {
		productRepository.deleteById(id);
		
	}
	
	public ProductModel  editProductById(Long id) {
		Optional<ProductEntity> optionalData= productRepository.findById(id);
		if(optionalData.isPresent())
		{
			ProductEntity product = optionalData.get();
			
			ProductModel productModel = new ProductModel();
			productModel.setName(product.getName());
			productModel.setBrand(product.getBrand());
			productModel.setMadein(null);
			productModel.setPrice(product.getPrice());
			productModel.setQuantity(product.getQuantity());
			productModel.setDiscountrate(0);
			return productModel;
		}
		else {
			return null;
		}
	}
	public ProductModel updateProductById(Long id, ProductModel productModel) {
		Optional<ProductEntity> optionalData= productRepository.findById(id);
		if(optionalData.isPresent())
		{
			ProductEntity product = optionalData.get();
			
		                ProductModel productModel1 = new ProductModel();
		                productModel1.setName(product.getName());
		                productModel1.setBrand(product.getBrand());
		                productModel1.setMadein(null); // Assuming this is intentional
		                productModel1.setPrice(product.getPrice());
		                productModel1.setQuantity(product.getQuantity());
		                productModel1.setDiscountrate(0); // Assuming default discount rate is 0
		                return productModel1;
		            }
		else {
			return null;
		}
		
	}
}
	
	

		
		
	
	
	
		


		
	
        
        
     
        
        
        
        
       
        
